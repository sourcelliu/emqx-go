<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{.Title}}</title>
    <link rel="stylesheet" href="/static/css/dashboard.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">EMQX Go Dashboard</div>
                <nav class="nav">
                    <a href="/dashboard" class="active">Dashboard</a>
                    <a href="/connections">Connections</a>
                    <a href="/sessions">Sessions</a>
                    <a href="/subscriptions">Subscriptions</a>
                    <a href="/blacklist">Blacklist</a>
                    <a href="/certificates">Certificates</a>
                    <a href="/tls-config">TLS Config</a>
                    <a href="/connectors">Connectors</a>
                    <a href="/rules">Rules</a>
                    <a href="/monitoring">Monitoring</a>
                </nav>
                <div class="user-menu">
                    <span>Welcome, admin</span>
                    <a href="/logout" class="btn btn-small">Logout</a>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content">
        <div class="container">
            <div class="page-header">
                <h1 class="page-title">Dashboard Overview</h1>
                <div style="display: flex; gap: 1rem; align-items: center;">
                    <label>
                        <input type="checkbox" id="auto-refresh" checked> Auto Refresh (5s)
                    </label>
                    <button id="refresh-btn" class="btn btn-primary btn-small">Refresh</button>
                    <span style="font-size: 0.9rem; color: #666;">Last updated: {{.CurrentTime}}</span>
                </div>
            </div>

            <!-- Metrics Grid -->
            <div class="dashboard-grid">
                <!-- Connections -->
                <div class="metric-card">
                    <div class="metric-title">Active Connections</div>
                    <div class="metric-value" id="connections-count">{{.Stats.Connections.Count}}</div>
                    <div class="metric-change">Max: <span id="connections-max">{{.Stats.Connections.Max}}</span></div>
                </div>

                <!-- Sessions -->
                <div class="metric-card">
                    <div class="metric-title">Active Sessions</div>
                    <div class="metric-value" id="sessions-count">{{.Stats.Sessions.Count}}</div>
                    <div class="metric-change">
                        Persistent: <span id="sessions-persistent">{{.Stats.Sessions.Persistent}}</span> |
                        Transient: <span id="sessions-transient">{{.Stats.Sessions.Transient}}</span>
                    </div>
                </div>

                <!-- Subscriptions -->
                <div class="metric-card">
                    <div class="metric-title">Subscriptions</div>
                    <div class="metric-value" id="subscriptions-count">{{.Stats.Subscriptions.Count}}</div>
                    <div class="metric-change">Max: <span id="subscriptions-max">{{.Stats.Subscriptions.Max}}</span></div>
                </div>

                <!-- Messages Received -->
                <div class="metric-card">
                    <div class="metric-title">Messages Received</div>
                    <div class="metric-value" id="messages-received">{{.Stats.Messages.Received}}</div>
                    <div class="metric-change">
                        QoS0: {{.Stats.Messages.Qos0}} | QoS1: {{.Stats.Messages.Qos1}} | QoS2: {{.Stats.Messages.Qos2}}
                    </div>
                </div>

                <!-- System Status -->
                <div class="metric-card">
                    <div class="metric-title">System Status</div>
                    <div class="metric-value">
                        <span class="status {{if eq .Health.Status "healthy"}}online{{else}}offline{{end}}" id="health-status">
                            {{if eq .Health.Status "healthy"}}Healthy{{else}}Unhealthy{{end}}
                        </span>
                    </div>
                    <div class="metric-change">Uptime: <span id="node-uptime">{{.Stats.Node.Uptime}}s</span></div>
                </div>
            </div>

            <!-- System Information -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">System Information</h2>
                </div>
                <div class="card-content">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                        <div>
                            <strong>Node:</strong> {{.Health.Node}}
                        </div>
                        <div>
                            <strong>Version:</strong> {{.Health.Version}}
                        </div>
                        <div>
                            <strong>OS:</strong> {{.Health.SystemInfo.OSInfo.OS}}/{{.Health.SystemInfo.OSInfo.Arch}}
                        </div>
                        <div>
                            <strong>CPUs:</strong> {{.Health.SystemInfo.OSInfo.NumCPU}}
                        </div>
                        <div>
                            <strong>Goroutines:</strong> <span id="goroutines-count">{{.Health.SystemInfo.Goroutines}}</span>
                        </div>
                        <div>
                            <strong>GC Count:</strong> {{.Health.SystemInfo.Memory.NumGC}}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="/static/js/dashboard.js"></script>
</body>
</html>